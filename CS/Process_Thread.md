## 프로세스 VS 스레드

---

### 프로세스(Process)
- 운영체제로부터 자원을 할당받은 작업의 단위

`메모리 구조`
- 코드(Text), 데이터, 스택, 힙 영역으로 구성

`코드`: 프로그램의 명령어가 작성되는 영역

`데이터`: 코드를 작성하면서 선언된 지역변수와 전역변수가 저장되는 영역
- .data, .bbs. .rodata 로 세분화 되어 있음
- .data: 초기화된 전역변수와 static 변수
- .bss: 초기화되지 않은 전역변수와 static 변수
- .rodata: 읽기 전용 데이터(상수)

`스택`: 함수 호출 시 생성되는 지역변수와 매개변수가 저장되는 영역

`힙`: 동적으로 할당된 메모리가 저장되는 영역


### 스레드(Thread)
- 프로세스 내에서 실행되는 작업의 단위

프로세스의 자원을 공유하면서 독립적으로 실행되는 흐름 단위
- `스택`은 각자의 스레드에서 실행되고, `코드`, `데이터`, `힙` 영역은 프로세스 내의 모든 스레드가 공유

`멀티스레드`
- 하나의 프로세스 내에서 여러 개의 스레드가 동시에 실행되는 것

`Process context switch`
- CPU가 한 프로세스에서 다른 프로세스로 전환될 때 발생하는 과정
- `대기(idle)` 상태에서 `실행(running)` 상태로 전환될 때, 운영체제는 현재 프로세스의 상태를 저장하고 새로운 프로세스의 상태를 복원

`PCB(Process Control Block)`: 운영체제에서 프로세스를 운용하기위해 프로세스 상태를 담고 있는 자료구조
- 컨텍스트 스위칭을 할 때 프로세스의 상태 정보를 저장하고 복원하는데 사용 (임시 저장소)
- 프로세스 ID, 프로그램 카운터, CPU 레지스터 상태, 메모리 관리 정보, 입출력 상태 정보 등 다양한 정보를 포함

`오버헤드(Overhead)`
- 프로세스에서 다른 프로세스로 전환될때 잠깐의 `idle` 상태가 발생 이 간극을 오버헤드라고 부른다.

`Thread context switch`
- CPU가 한 스레드에서 다른 스레드로 전환될 때 발생하는 과정
- 스레드 간의 전환은 프로세스 간의 전환보다 훨씬 빠르다. 왜냐하면 스레드는 같은 프로세스 내에서 실행되기 때문에, 메모리 맵과 같은 프로세스 수준의 자원을 다시 로드할 필요가 없기 때문이다.
- 한 프로세스안에 여러 스레드가 동작하므로, 스레드간 상호작용과 동기화 문제를 고려해야 한다.

---

`추가`

`Volatile`
- 멀티스레드 환경에서 변수의 가시성을 보장하기 위해 사용되는 키워드
- 스레드에 캐시 된 자원을 읽지않고 항상 메인 메모리에서 읽도록 강제
- 주로 boolean 변수 또는 알림 상태에만 사용된다.

---
`면접 예상 질문`

1. 프로세스와 스레드의 차이점은 무엇인가요?
    - 답변: 프로세스는 운영체제에서 프로그램이 실행중인 인스턴스로, 독립적인 메모리 공간을 가지는 실행 단위 입니다.
           반면 스레드는 프로세스 안에서 실행되는 작업의 단위로, 같은 프로세스 내에서 `스택`, `레지스터`를 제외한
           `코드`, `데이터`, `힙` 영역을 공유합니다.
2. 프로세스와 스레드는 어떤 자원을 각각 공유하고, 어떤 자원은 분리되어 있나요?
    - 답변: 프로세스와 스레드는 `코드`, `데이터`, `힙` 영역을 공유하지만, `스택`과 `레지스터`는 각각 독립적으로 분리되어 있습니다.
3. 프로세스 컨텍스트 스위칭과 스레드 컨텍스트 스위칭의 차이는 무엇인가요?
    - 답변: 프로세스 컨텍스트 스위칭은 주소 공간 자체가 변경되기 때문에 페이지 테이블 변경 등 비용이 크지만, 스레드 스위칭은 같은 프로세스 내에서 레지스터와 스택만 교체하면 되기 때문에 상대적으로 비용이 적습니다.
4. 웹 서버나 Spring 기반 서비스에서는 왜 멀티 프로세스보다 멀티 스레드 구조를 더 많이 사용할까요?
    - 답변: 웹 서버에서는 요청마다 독립된 작업을 처리해야 하므로 멀티 스레드 구조가 적합합니다.
           프로세스 기반일 경우 자원 생성과 비용이 크고 IPC 비용도 발생하지만, 스레드는 메모리를 공유하므로 빠른요청 처리와 더 효율적인 자원 사용이 가능합니다.
5. 멀티 스레드 환경에서 발생할 수 있는 문제에는 무엇이 있고, 어떻게 해결하나요?
    - 답변: 멀티 스레드 환경에서는 동기화, Deadlock, Race Condition 등의 문제가 발생할 수 있습니다.
           이를 방지하기 위해 synchronized 블록, Lock, Concurrent 등의 패키지를 사용하거나 불변 객체를 활용하는 방식으로 해결할 수 있습니다.
6. PCB(Process Control Block)는 무엇이며, 컨텍스트 스위칭에서 어떤 역할을 하나요?
    - 답변: PCB는 프로세스의 상태를 저장하는 자료구조로, 컨텍스트 스위칭 시 현재 프로세스의 상태 정보를 저장하고 새로운 프로세스의 상태를 복원하는 역할을 합니다.
7. 멀티스레딩의 장점과 단점은 무엇인가요?
    - 답변: 장점으로는 자원 공유로 인한 메모리 효율성, 빠른 응답성, 병렬 처리 등이 있습니다.
           단점으로는 동기화 문제, 디버깅 어려움, 컨텍스트 스위칭 오버헤드 등이 있습니다.
8. Volatile이 synchronized를 대체할 수 있나요?
   - 답변: Volatile은 변수의 가시성을 보장하지만, 원자성을 보장하지 않기 때문에 synchronized를 완전히 대체할 수 없습니다.
           Volatile은 주로 상태 플래그나 단순한 읽기/쓰기 작업에 사용되고, 복잡한 동기화가 필요한 경우에는 synchronized나 Lock을 사용해야 합니다.
